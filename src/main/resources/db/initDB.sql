DROP TABLE IF EXISTS products;
DROP TABLE IF EXISTS users;

CREATE TABLE users
(
  id           INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  name         VARCHAR                     NOT NULL,
  date         TIMESTAMP                   NOT NULL,
  email        VARCHAR                     NOT NULL,
  password     VARCHAR                     NOT NULL,
  enabled      BOOL DEFAULT TRUE           NOT NULL,
  country      VARCHAR                     NOT NULL,
  city         VARCHAR                     NOT NULL,
  balance      INTEGER DEFAULT 0           NOT NULL
);
CREATE UNIQUE INDEX users_unique_email_idx ON users (email);

CREATE TABLE products
(
  id                  INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  name                VARCHAR                     NOT NULL,
  date                TIMESTAMP                   NOT NULL,
  asin                VARCHAR                     NOT NULL,
  title               VARCHAR                     NOT NULL,
  price               DOUBLE PRECISION            NOT NULL,
  image               VARCHAR                     NOT NULL,
  description         VARCHAR                     NOT NULL,
  active_orders       INTEGER DEFAULT 0           NOT NULL,
  completed_orders    INTEGER DEFAULT 0           NOT NULL,
  user_id             INTEGER                     NOT NULL,
  FOREIGN KEY (user_id) REFERENCES USERS (id) ON DELETE CASCADE
);
CREATE UNIQUE INDEX products_unique_asin ON products (asin);